## RSA
### RSA
---
#### RSA 암호 알고리즘
대칭키와는 달리 두 개의 키가 사용된다. 하나는 공개키로 모든 사용자에게 공개되며, 평문을 암호화할 때 사용한다. 다른 하나는 개인키로 타인에게 노출되어서는 안 되며, 공개키로 암호화된 암호문을 복호화할 때 사용한다.
* 오일러 정리
n과 서로소인 양의 정수 m이 m^φ(n) ≡ 1(mod n)을 만족한다는 정리이다.여기서 φ(n)는 오일러 파이 함수라고 불리며, n이하의 양의 정수 중에서 n과 서로소인 수의 개수를 의미한다.
* 키 생성
먼저 서로 다른 두 소수 p와 q를 선택한다. 일반적으로 1024비트 이상에서 비트길이가 같은 수로 생성한다. 그 뒤, p와 q를 곱하여 n을 구하고, φ(n)을 계산한다. n을 구하는 식은 p * q이다. 위 과정에서 e가 구해지는 e를 공개 지수, n은 modules, d는 비밀 지수라고 불린다.
* 암호화
공개키 n,e로 n보다 작은 평문 m을 암호화할 때, 암호문 c는 c ≡ m^e (mod n) 식으로 구해집니다.
* 복호화
암호문 c를 개인키 d로 복호화할 때, 평문 m은 m ≡ c^d (mod n), c^d ≡ (m^e)^d ≡ m^{ed} (mod n)로 구해진다. 오일러 정리에 따르면 d ≡ e^−1 (mod φ(n))이므로 ed = kφ(n) + 1을 만족하는 자연수 k가 존재한다. 그래서 m^ed ≡ (m^φ(n))^k m(mod n)이 성립한다. 또한 오일러 정리에 의해 m^φ(n) ≡ 1(mod n)이므로 (m^φ(n))^k m ≡ m (mod n)이다.
### RSA 공격
---
#### 작은 e
빠른 암호화를 위해 공개지수 e를 너무 작게 설정하면 발생하는 공격이다. 그렇다고 해서 너무 크게하면 효율성이 떨어지므로 일반적으로 2^16 + 1 = 65537을 사용한다.
* Coppersmith
차수가 e인 함수 f(x)에서 찾고자 하는 근이 n^1/e보다 작을 경우, 복잡도가 O(log n)인 알고리즘을 이용하여 근을 구할 수 있다. 
* Hastad's Broadcast 공격
한 송신자가 다수의 수신자에게 동일한 평문을 전송할 때, 수신자들에게 모두 동일한 작은 e값을 사용할 경우 가능한 공격 방법이다. 중국인의 나머지 정리를 이용하여 m^3 = c 라는 등식을 얻어 평문 m을 구할 수 있다.
#### 공통 n
* Common Modules Attack
같은 n과 서로소인 두 공개 지수 e1, e2를 사용하여 같은 평문 m을 암호화해서 두 암호문 c1, c2를 만들었을 때 공격하는 기법이다. 확장 유클리드 호제법을 이용하여 m을 구한다. 따라서 n은 공통된 값이 아닌 무작위 값으로 생성해야 한다.
#### 작은 d
d < 1/3n^0.25인 경우 Winner's attack을 이용해 d를 복구해낼 수 있으며, Boneh Durfee attack를 사용하면 더 넓은 범위의 d도 복구할 수 있다. 따라서 비밀지수인 d는 n보다 적당히 큰 수가 되도록 해줘야한다.
 